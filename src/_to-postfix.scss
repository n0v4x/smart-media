@function to-postfix($expression) {
  $postfix: ();
  $operators-stack: ();

  @each $item in $expression {
    @if (is-operator($item)) {
      $operator-1: $item;
      $operator-2: last($operators-stack);

      @while (
        is-operator($operator-2) and
          (
            get-operator-precedence($operator-1) <=
              get-operator-precedence($operator-2)
          )
      ) {
        $postfix: append($postfix, $operator-2);
        $operators-stack: remove-last($operators-stack);
        $operator-2: last($operators-stack);
      }
      $operators-stack: append($operators-stack, $operator-1);
    } @else if type-of($item) == "list" {
      $postfix: join($postfix, to-postfix($item));
    } @else {
      $postfix: append($postfix, $item);
    }
  }

  @each $operator in reverse($operators-stack) {
    $postfix: append($postfix, $operator);
  }

  @return $postfix;
}
